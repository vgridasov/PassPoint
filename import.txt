Описание импорта сотрудников:

Интерфейс импорта:
В админке сотрудников есть кнопка "Импорт"
Поддерживаются форматы CSV, XLS, XLSX
Используется стандартный интерфейс django-import-export

Логирование:
Логируется начало импорта
Логируется создание/обновление подразделений
Логируется создание/обновление должностей
Логируется копирование фотографий
Логируется создание/обновление сотрудников

Обработка ошибок:
Проверка существования подразделения по ID
Проверка существования должности по ID
Проверка существования файла фотографии
Логирование всех ошибок

Формат данных:
Подразделение можно указать как ID или название
Должность можно указать как ID или название
Фото можно указать как относительный путь или полный путь
Все текстовые поля автоматически очищаются от пробелов

Автоматическое создание:
Если подразделение не найдено - создается новое
Если должность не найдена - создается новая
При создании full_name копируется из name

Результаты импорта:
Логируется количество созданных/обновленных записей
В админке показываются сообщения об успехе/ошибках
В логах сохраняется детальная информация о каждом действии

Логика импорта сотрудников:

1. Подготовка данных:
   - Очистка строковых полей от лишних пробелов (фамилия, имя, отчество, подразделение, должность)
   - Проверка наличия обязательных полей (фамилия, имя, подразделение, должность)

2. Обработка подразделения:
   - Если значение числовое - поиск по ID
   - Если текстовое - поиск по названию или создание нового
   - При создании нового подразделения full_name = name
   - Логирование создания/нахождения подразделения

3. Обработка должности:
   - Если значение числовое - поиск по ID
   - Если текстовое - поиск по названию или создание новой
   - При создании новой должности full_name = name
   - Логирование создания/нахождения должности

4. Проверка существующего сотрудника:
   - Поиск по комбинации: фамилия + имя + отчество + подразделение + должность
   - При нахождении существующего сотрудника:
     * Обновление только непустых полей (фото, пропуск, статус увольнения)
     * Прерывание импорта текущей строки
   - Логирование обновления

5. Обработка фотографии:
   - Проверка наличия пути к фото
   - Если фото не в папке employee_photos:
     * Создание директории employee_photos
     * Копирование файла в employee_photos
     * Обновление пути в данных
   - Логирование копирования/ошибок

6. Сопоставление полей:
   - Поддержка русских заголовков:
     * Фамилия -> last_name
     * Имя -> first_name
     * Отчество -> middle_name
     * Подразделение -> department
     * Должность -> position
     * Пропуск -> has_pass
     * Уволен -> is_fired

7. Логирование:
   - Все этапы импорта логируются
   - Ошибки записываются с детальным описанием
   - Успешные операции отмечаются информационными сообщениями

8. Обработка ошибок:
   - Каждый этап имеет обработку исключений
   - При ошибке импорт строки прерывается
   - Все ошибки логируются с контекстом

9. Результаты импорта:
   - Создание новых сотрудников
   - Обновление существующих сотрудников
   - Логирование результатов по каждой строке
